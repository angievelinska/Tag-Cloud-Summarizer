

Use the <analytics:trackingimage> tag for tracking page views and context views through the loading of images.

Without further configuration, this tag tracks the view of most recently opened page context, object context or name context. By separating this tag from the context tags, the designer has more leeway in placing the tracking images. 

A typical usage looks as follows:

<analytics:pagecontext object="${self}" view="...">
   ...
   <analytics:trackingimage rgb="ffffff"/>
   ...
</analytics:pagecontext>


This would render a single-pixel image with the given RGB value indicating a white image. Instead of specifying the RGB value, you can also put your own image into the directory WEB-INF/tracker-resources of your web application and specify the name of the image in the src attribute of the tag. Some images are already predefined. The next example renders a transparent image:

<analytics:trackingimage src="empty.gif"/>

Note that such images are fetched from the local disk upon every request, which may be considerably more expensive than generating a single-pixel image from main memory.

You can use any attribute that is also allowed for the HTML <IMG> element. The only exception is the class attribute, which must be given as the styleClass attribute.

<analytics:trackingimage rgb="ffffff" styleClass="mystyle"/>

When the <analytics:trackingimage> tag appears inside a name context or object context, it results in the logging of a context view instead of a page view. Care should be taken to place the tag outside of any nested tag, but inside the page context tag, if the page view is supposed to be tracked.

When a tracking image tag is present, the context tag will not log a view immediately itself. The view will be tracked when the tracking image is fetched. However, the view is tracked if and only if the context tag would have logged the view. Specifically, for a page context that attribute logView must not be explicitly set to false and for an object context or a name context the attribute logView must be explicitly set to true.

If the tracking image tag contains any of the attributes object, view, locale, or context, a special event with the given parameters is logged regardless of the setting of logView of the encapsulating context and the logging of the encapsulating context tag is not disabled.

Unless this is suppressed through configuration in the file trackingbase.properties, the rendered output for tracking page views contains JavaScript code to determine the referring page. This allows additional reports to be generated, but the generated output is more complex. The basic structure of the output is shown next:

<script type="text/javascript">
<!--
document.write('<img src="...'+escape(document.referrer)+'" />');
// -->
</script><noscript><img src="..." /></noscript>

By providing a <noscript> replacement, it is ensured that even browsers with disabled JavaScript render the same image, passing as much information as possible to the tracking controller.