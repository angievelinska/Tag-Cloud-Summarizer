<div xmlns="http://www.coremedia.com/2003/richtext-1.0" xmlns:xlink="http://www.w3.org/1999/xlink"><p class="p--heading-2">Authentication</p><p>A user provider (interface <span class="inlineformat--code">com.coremedia.sse.base.authentication.UserProvider</span>)<em> </em>is responsible for validating login requests, mapping authenticated users to SSE <span class="inlineformat--code">User</span> resources, and creating a <span class="inlineformat--code">Subject</span> for the user for authorization purposes. For certain scenarios, a user provider may also support the semi-automatic creation of a <span class="inlineformat--code">User</span> resource for users who have authenticated successfully against an external authentication system, but login for the first time and therefore do not have a corresponding <em>User</em> resource yet.</p><p>The code fragment below shows a typical login sequence calling on both the user provider for authentication and the <span class="inlineformat--code">SessionManager</span> to create a new <span class="inlineformat--code">UserSession</span>:</p><ul><li>create a new authentication request object and store the given credentials (the type of the authentication request and the nature of the credentials depends on the choice of the user provider implementation). <span class="inlineformat--code">DefaultUserProvider</span> only supports requests of type <span class="inlineformat--code">NamePasswordAuthenticationRequest</span></li><li>invoke <span class="inlineformat--code">#authenticate</span> on the respective user provider. If the authentication succeeds, "userProvider" returns an <em>AuthenticationToken</em>, otherwise it throws an exception</li><li>retrieve the corresponding <span class="inlineformat--code">User</span> resource representing the authenticated user from the "userProvider": in case of an external authentication system, such as a LDAP directory, no such resource may exist yet and it must be created first, either by guiding users through a registration process to setup their profiles (keep the authentication token to create the session later), or automatically without user intervention. In both cases, call <span class="inlineformat--code">UserProvider#createUser</span> to allow the provider to add authentication system specific information to the user profile. If the local <em>SSE</em> repository is used for authentication (via <span class="inlineformat--code">PasswordCardVerifier</span>, see below), the user resource will always exist upon successful authentication.</li><li>let the "userProvider" create a <span class="inlineformat--code">Subject</span> for the authenticated user and pass the User resource, the token, and the Subject to the "sessionManager" bean in order to complete the login process</li></ul><p class="p--codeblock">    // supported auth request types depend on userProvider <br/>    // implementation, here: DefaultUserProvider<br/>    NamePasswordAuthenticationRequest request = <br/>      new NamePasswordAuthenticationRequest(name, password);<br/><br/>    AuthenticationToken token = userProvider.authenticate(request);<br/><br/>    User user = userProvider.getUser(request, token);<br/>    if (user == null) {<br/>      // authentication successful, but no User resource yet:<br/>      // in this case we could present a registration dialog or<br/>      // transparently create the User resource <br/>      // by calling userProvider.createUser(...)<br/>    }<br/><br/>    ...<br/><br/>    // assumption: user != null exists<br/>    Subject subject = userProvider.getSubject(token, user);<br/><br/>    UserSession session = <br/>    sessionManager.createSession(user, token, subject);</p><p/></div>